import{d as j,r as m,l as F,z as G,c as U,w as o,A as H,u as J,a as s,o as I,b as e,f as K,g as _,B as O,C as Q}from"./index-DZhxj18n.js";import{_ as W}from"./UnsavedChangesDialog.vue_vue_type_script_setup_true_lang-D3NdNa9i.js";import{u as X}from"./use-validation-rules-CMFBqc6K.js";import{l as k}from"./lodash-Bvz3dTqJ.js";import{u as Y}from"./use-imprints-DjQc1I_v.js";import{_ as Z}from"./_plugin-vue_export-helper-DlAUqK2U.js";const h=j({__name:"ImprintView",setup(ee){const y=H(),p=J(),{notifyInfo:S,notifyError:R}=Q(),{requiredRule:V,accountingCodeRule:E}=X(),{getImprint:N,emptyImprint:b,saveImprint:A}=Y(),w=m(void 0),f=m(!0),i=m(!1),r=m(""),c=m(!1),a=m(b()),C=m(null);F(async()=>{if(f.value=!0,y.params.imprintId==="new")a.value=b();else{const d=Number(y.params.imprintId);a.value=await N(d)}C.value=k.cloneDeep(a.value),f.value=!1,i.value=!1,r.value=""}),G(d=>!i.value&&!k.isEqual(a.value,C.value)?(r.value=d.name,c.value=!0,!1):!0);function B(){c.value=!1,g(),p.push({name:r.value||"imprints-view"})}function D(){c.value=!1,i.value=!0,O().then(()=>{p.push({name:r.value||"imprints-view"})})}async function g(){var l;const d=await w.value.validate();d.valid?(await A(a.value),i.value=!0,p.push({name:r.value||"imprints-view"}),S(`${(l=a.value)==null?void 0:l.imprint_name} saved`)):(document.querySelector(`#${d.errors[0].id}`).focus(),R("Check the form for errors and try saving again"))}function $(){i.value=!0,p.push({name:"imprints-view"})}return(d,l)=>{const q=s("v-progress-linear"),u=s("v-text-field"),n=s("v-col"),z=s("v-select"),v=s("v-row"),L=s("v-textarea"),x=s("v-btn"),M=s("v-form"),P=s("v-card-text"),T=s("v-card");return f.value?(I(),U(q,{key:0,indeterminate:"",color:"primary"})):(I(),U(T,{key:1,title:"Add / Edit Imprint"},{default:o(()=>[e(P,null,{default:o(()=>[e(M,{ref_key:"form",ref:w,"validate-on":"submit",density:"compact",onSubmit:K(g,["prevent"])},{default:o(()=>[e(v,null,{default:o(()=>[e(n,{cols:"6"},{default:o(()=>[e(u,{modelValue:a.value.imprint_name,"onUpdate:modelValue":l[0]||(l[0]=t=>a.value.imprint_name=t),label:"Imprint Name",rules:[_(V)],density:"compact","data-cy":"imprint-name"},null,8,["modelValue","rules"])]),_:1}),e(n,{cols:"4"},{default:o(()=>[e(u,{modelValue:a.value.accounting_code,"onUpdate:modelValue":l[1]||(l[1]=t=>a.value.accounting_code=t),label:"Accounting Code",rules:[_(V),_(E)],density:"compact","data-cy":"accounting-code"},null,8,["modelValue","rules"])]),_:1}),e(n,{cols:"2"},{default:o(()=>[e(z,{modelValue:a.value.status,"onUpdate:modelValue":l[2]||(l[2]=t=>a.value.status=t),label:"Status",items:["active","archived"],density:"compact","data-cy":"imprint-status"},null,8,["modelValue"])]),_:1})]),_:1}),e(v,null,{default:o(()=>[e(n,{cols:"4"},{default:o(()=>[e(u,{modelValue:a.value.contact_name,"onUpdate:modelValue":l[3]||(l[3]=t=>a.value.contact_name=t),label:"Contact Name",density:"compact","data-cy":"contact-name"},null,8,["modelValue"])]),_:1}),e(n,{cols:"4"},{default:o(()=>[e(u,{modelValue:a.value.email,"onUpdate:modelValue":l[4]||(l[4]=t=>a.value.email=t),label:"Email",density:"compact","data-cy":"email"},null,8,["modelValue"])]),_:1}),e(n,{cols:"4"},{default:o(()=>[e(u,{modelValue:a.value.phone,"onUpdate:modelValue":l[5]||(l[5]=t=>a.value.phone=t),label:"Phone",density:"compact","data-cy":"phone"},null,8,["modelValue"])]),_:1})]),_:1}),e(v,null,{default:o(()=>[e(n,{cols:"6"},{default:o(()=>[e(u,{modelValue:a.value.address1,"onUpdate:modelValue":l[6]||(l[6]=t=>a.value.address1=t),label:"Address 1",density:"compact","data-cy":"address1"},null,8,["modelValue"])]),_:1}),e(n,{cols:"6"},{default:o(()=>[e(u,{modelValue:a.value.address2,"onUpdate:modelValue":l[7]||(l[7]=t=>a.value.address2=t),label:"Address 2",density:"compact","data-cy":"address2"},null,8,["modelValue"])]),_:1})]),_:1}),e(v,null,{default:o(()=>[e(n,{cols:"4"},{default:o(()=>[e(u,{modelValue:a.value.city,"onUpdate:modelValue":l[8]||(l[8]=t=>a.value.city=t),label:"City",density:"compact","data-cy":"city"},null,8,["modelValue"])]),_:1}),e(n,{cols:"3"},{default:o(()=>[e(u,{modelValue:a.value.state,"onUpdate:modelValue":l[9]||(l[9]=t=>a.value.state=t),label:"State",density:"compact","data-cy":"state"},null,8,["modelValue"])]),_:1}),e(n,{cols:"3"},{default:o(()=>[e(u,{modelValue:a.value.postal_code,"onUpdate:modelValue":l[10]||(l[10]=t=>a.value.postal_code=t),label:"Postal Code",density:"compact","data-cy":"postal-code"},null,8,["modelValue"])]),_:1}),e(n,{cols:"2"},{default:o(()=>[e(u,{modelValue:a.value.country,"onUpdate:modelValue":l[11]||(l[11]=t=>a.value.country=t),label:"Country",density:"compact","data-cy":"country"},null,8,["modelValue"])]),_:1})]),_:1}),e(L,{modelValue:a.value.notes,"onUpdate:modelValue":l[12]||(l[12]=t=>a.value.notes=t),label:"Notes",rows:"2",density:"compact","data-cy":"notes"},null,8,["modelValue"]),e(v,null,{default:o(()=>[e(n,{cols:"12"},{default:o(()=>[e(x,{type:"submit",text:"Save",color:"primary",size:"small","data-cy":"save-imprint"}),e(x,{class:"ml-4",text:"Cancel",size:"small","data-cy":"cancel-imprint",onClick:$})]),_:1})]),_:1})]),_:1},512),e(W,{show:c.value,"item-name":"imprint",onSave:B,onDontSave:D,onCancelled:l[13]||(l[13]=t=>c.value=!1)},null,8,["show"])]),_:1})]),_:1}))}}}),se=Z(h,[["__scopeId","data-v-ac157eb1"]]);export{se as default};
