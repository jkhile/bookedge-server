import{u as K}from"./use-books-NIUH2Quq.js";import{d as O,r,k as p,l as Q,m as W,c as g,w as t,a,o as w,b as o,n as X,h as v,p as x,i as B,t as S,q as Y,s as Z,v as ee,e as oe}from"./index-BmIoG3EC.js";import{l as te}from"./lodash-CMk6ASS6.js";import{_ as ae}from"./ConfirmationDialog.vue_vue_type_script_setup_true_lang-C-3IeOeY.js";import{_ as se}from"./_plugin-vue_export-helper-DlAUqK2U.js";const ne=l=>(Z("data-v-ac93b79e"),l=l(),ee(),l),le=ne(()=>oe("span",{class:"text-h6"},"Books",-1)),ce=O({__name:"BooksView",setup(l){const{books:f,findBooks:C,archiveBook:P}=K(),u=r(!1),c=p("booksShowArchived",!1),d=r(""),k=p("booksItemsPerPage",10),_=p("booksSort",[{key:"book_name",order:"asc"}]),i=r(!1),h=r({}),V=[{title:"Title",key:"title"},{title:"Accounting Code",key:"accounting_code"},{title:"Author",key:"author"},{title:"Published Date",key:"published_date"},{title:"Issues",key:"issues_count"},{title:"Status",key:"status"},{title:"Actions",key:"actions",sortable:!1}];Q(async()=>{u.value=!0,await C({}),u.value=!1});const I=W(()=>c.value?f.value:f.value.filter(s=>s.status!=="archived"));function A(s){return te.truncate(s.title,{length:60})}const T=s=>{k.value=s},U=s=>{Y.push({name:"metadata-view",params:{bookId:s.toString()}})},$=s=>{h.value=s,i.value=!0},D=async()=>{i.value=!1,await P(h.value.id)};return(s,n)=>{const N=a("v-progress-circular"),q=a("v-btn"),y=a("router-link"),z=a("v-tooltip"),m=a("v-col"),E=a("v-switch"),L=a("v-text-field"),M=a("v-row"),R=a("v-card-title"),j=a("v-chip"),b=a("v-icon"),F=a("v-data-table"),G=a("v-card-text"),H=a("v-card");return u.value?(w(),g(N,{key:0,indeterminate:"",color:"primary"})):(w(),g(H,{key:1},{default:t(()=>[o(R,null,{default:t(()=>[o(M,{class:"mt-1"},{default:t(()=>[o(m,{cols:"6"},{default:t(()=>[le,o(z,{text:"Add an book"},{activator:t(({props:e})=>[o(y,{to:{name:"metadata-view",params:{bookId:"new"}}},{default:t(()=>[o(q,X({class:"ml-4"},e,{color:"info",icon:"mdi-plus",size:"x-small","data-cy":"new-book"}),null,16)]),_:2},1024)]),_:1})]),_:1}),o(m,{cols:"2",align:"right"},{default:t(()=>[o(E,{modelValue:v(c),"onUpdate:modelValue":n[0]||(n[0]=e=>x(c)?c.value=e:null),label:"Show archived books",color:"primary","data-cy":"show-archived"},null,8,["modelValue"])]),_:1}),o(m,{cols:"4",align:"right"},{default:t(()=>[o(L,{modelValue:d.value,"onUpdate:modelValue":n[1]||(n[1]=e=>d.value=e),"append-inner-icon":"mdi-magnify",label:"Search",density:"compact",clearable:"","single-line":"","data-cy":"search"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),o(G,null,{default:t(()=>[o(F,{class:"elevation-1","sort-by":v(_),"onUpdate:sortBy":n[2]||(n[2]=e=>x(_)?_.value=e:null),headers:V,items:I.value,"items-per-page":v(k),search:d.value,density:"compact","data-cy":"books-table","onUpdate:itemsPerPage":T},{"item.title":t(({item:e})=>[o(y,{to:{name:"metadata-view",params:{bookId:e.id}}},{default:t(()=>[B(S(A(e)),1)]),_:2},1032,["to"])]),"item.issues_count":t(({item:e})=>[o(j,{variant:"flat",color:e.issues_count>0?"red":"green"},{default:t(()=>[B(S(e.issues_count),1)]),_:2},1032,["color"])]),"item.actions":t(({item:e})=>[o(b,{icon:"mdi-pencil",color:"primary",onClick:J=>U(e.id)},null,8,["onClick"]),o(b,{class:"ml-2",icon:"mdi-minus-circle",color:"grey","data-cy":"archive-book",onClick:J=>$(e)},null,8,["onClick"])]),_:1},8,["sort-by","items","items-per-page","search"])]),_:1}),o(ae,{show:i.value,text:"Are you sure you want to archive this book?",onConfirmed:D,onCancelled:n[3]||(n[3]=e=>i.value=!1)},null,8,["show"])]),_:1}))}}}),me=se(ce,[["__scopeId","data-v-ac93b79e"]]);export{me as default};
