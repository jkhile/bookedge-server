import{u as q}from"./use-contributors-7riZpckG.js";import{d as E,r as i,k as b,l as F,m as G,c as f,w as n,A as H,u as J,a as o,o as y,b as t,n as K,g,p as O,h as Q,t as W,e as X}from"./index-DZhxj18n.js";import{_ as Y}from"./ConfirmationDialog.vue_vue_type_script_setup_true_lang-BrLax0J_.js";const Z=X("span",{class:"text-h6"},"Contributors",-1),at=E({__name:"BookContributorsView",setup(tt){const{contributors:k,findContributors:h,removeContributor:C}=q(),l=i(!1),c=i(""),d=b("contributorsItemsPerPage",10),u=b("contributorsSort",[{key:"contributor_name",order:"asc"}]),s=i(!1),_=i({}),w=H(),x=J(),P=[{title:"Role",key:"contributor_role"},{title:"Published Name",key:"published_name"},{title:"Legal Name",key:"legal_name"},{title:"Actions",key:"actions",sortable:!1}];F(async()=>{l.value=!0,await h({fk_book:Number(w.params.bookId)}),l.value=!1});const V=G(()=>k.value),A=a=>{d.value=a},B=a=>{x.push({name:"contributor-view",params:{contributorId:a.toString()}})},I=a=>{_.value=a,s.value=!0},N=async()=>{s.value=!1,await C(_.value.id)};return(a,r)=>{const S=o("v-progress-circular"),R=o("v-btn"),p=o("router-link"),$=o("v-tooltip"),m=o("v-col"),U=o("v-text-field"),D=o("v-row"),L=o("v-card-title"),v=o("v-icon"),T=o("v-data-table"),z=o("v-card-text"),M=o("v-card");return l.value?(y(),f(S,{key:0,indeterminate:"",color:"primary"})):(y(),f(M,{key:1},{default:n(()=>[t(L,null,{default:n(()=>[t(D,{class:"mt-1"},{default:n(()=>[t(m,{cols:"4"},{default:n(()=>[Z,t($,{text:"Add an contributor"},{activator:n(({props:e})=>[t(p,{to:{name:"contributor-view",params:{contributorId:"new"}}},{default:n(()=>[t(R,K({class:"ml-4"},e,{color:"info",icon:"mdi-plus",size:"x-small","data-cy":"add-item"}),null,16)]),_:2},1024)]),_:1})]),_:1}),t(m,{cols:"2",align:"right"}),t(m,{cols:"6",align:"right"},{default:n(()=>[t(U,{modelValue:c.value,"onUpdate:modelValue":r[0]||(r[0]=e=>c.value=e),"append-inner-icon":"mdi-magnify",label:"Search",density:"compact",clearable:"","single-line":"","data-cy":"search"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),t(z,null,{default:n(()=>[t(T,{class:"elevation-1","sort-by":g(u),"onUpdate:sortBy":r[1]||(r[1]=e=>O(u)?u.value=e:null),headers:P,items:V.value,"items-per-page":g(d),search:c.value,density:"compact","data-cy":"contributors-table","onUpdate:itemsPerPage":A},{"item.published_name":n(({item:e})=>[t(p,{to:{name:"contributor-view",params:{contributorId:e.id}}},{default:n(()=>[Q(W(e.published_name),1)]),_:2},1032,["to"])]),"item.actions":n(({item:e})=>[t(v,{icon:"mdi-pencil",color:"primary","data-cy":"edit-contributor",onClick:j=>B(e.id)},null,8,["onClick"]),t(v,{class:"ml-2",icon:"mdi-minus-circle",color:"grey","data-cy":"remove-contributor",onClick:j=>I(e)},null,8,["onClick"])]),_:1},8,["sort-by","items","items-per-page","search"])]),_:1}),t(Y,{show:s.value,text:"Are you sure you want to remove this contributor?",onConfirmed:N,onCancelled:r[2]||(r[2]=e=>s.value=!1)},null,8,["show"])]),_:1}))}}});export{at as default};
