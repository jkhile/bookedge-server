import{d as q,r as i,l as F,z as M,c as C,w as t,A as W,u as G,a as d,o as U,b as e,f as J,g as X,B as j,C as H}from"./index-DZhxj18n.js";import{_ as K}from"./UnsavedChangesDialog.vue_vue_type_script_setup_true_lang-D3NdNa9i.js";import{u as O}from"./use-validation-rules-CMFBqc6K.js";import{l as x}from"./lodash-Bvz3dTqJ.js";import{u as Q}from"./use-contributors-7riZpckG.js";import{_ as Y}from"./_plugin-vue_export-helper-DlAUqK2U.js";const Z=q({__name:"BookContributorView",setup(ee){const b=W(),p=G(),{notifyInfo:A,notifyError:I}=H(),{requiredRule:R}=O(),{getContributor:B,emptyContributor:y,saveContributor:E}=Q(),_=i(void 0),f=i(!0),m=i(!1),v=i(""),c=i(!1),a=i(y()),V=i(null),N=["Author","Joint Author","Abridged by","Adapted by","Afterword by","Annotations by","Appendix by","Based on a Book by","Compiled by","Contribution by","Cover Design by","Designed by","Editor","Epilogue by","Foreword by","Illustrator","Indexed by","Interviewer","Introduction by","Preface by","Research by","Revised by","Translator"];F(async()=>{if(f.value=!0,b.params.contributorId==="new")a.value=y(),a.value.fk_book=Number(b.params.bookId);else{const s=Number(b.params.contributorId);a.value=await B(s)}V.value=x.cloneDeep(a.value),f.value=!1,m.value=!1,v.value=""}),M(s=>!m.value&&!x.isEqual(a.value,V.value)?(v.value=s.name,c.value=!0,!1):!0);function z(){c.value=!1,g(),p.push({name:v.value||"contributors-view"})}function S(){c.value=!1,m.value=!0,j().then(()=>{p.push({name:v.value||"contributors-view"})})}async function g(){var l;const s=await _.value.validate();s.valid?(await E(a.value),m.value=!0,p.push({name:v.value||"contributors-view"}),A(`Contributor ${(l=a.value)==null?void 0:l.published_name} saved`)):(document.querySelector(`#${s.errors[0].id}`).focus(),I("Check the form for errors and try saving again"))}function D(){m.value=!0,p.push({name:"contributors-view"})}return(s,l)=>{const h=d("v-progress-linear"),P=d("v-select"),u=d("v-col"),n=d("v-text-field"),r=d("v-row"),k=d("v-textarea"),w=d("v-btn"),L=d("v-form"),T=d("v-card-text"),$=d("v-card");return f.value?(U(),C(h,{key:0,indeterminate:"",color:"primary"})):(U(),C($,{key:1,title:"Add / Edit Contributor"},{default:t(()=>[e(T,null,{default:t(()=>[e(L,{ref_key:"form",ref:_,"validate-on":"submit",density:"compact",onSubmit:J(g,["prevent"])},{default:t(()=>[e(r,null,{default:t(()=>[e(u,{cols:"2"},{default:t(()=>[e(P,{modelValue:a.value.contributor_role,"onUpdate:modelValue":l[0]||(l[0]=o=>a.value.contributor_role=o),label:"Contributor Role",items:N,density:"compact","data-cy":"contributor-role"},null,8,["modelValue"])]),_:1}),e(u,{cols:"5"},{default:t(()=>[e(n,{modelValue:a.value.published_name,"onUpdate:modelValue":l[1]||(l[1]=o=>a.value.published_name=o),label:"Published Name",rules:[X(R)],clearable:"",density:"compact","data-cy":"published-name"},null,8,["modelValue","rules"])]),_:1}),e(u,{cols:"5"},{default:t(()=>[e(n,{modelValue:a.value.legal_name,"onUpdate:modelValue":l[2]||(l[2]=o=>a.value.legal_name=o),label:"Legal Name (if different)",density:"compact","data-cy":"legal-name"},null,8,["modelValue"])]),_:1})]),_:1}),e(r,null,{default:t(()=>[e(u,{cols:"12"},{default:t(()=>[e(k,{modelValue:a.value.biography,"onUpdate:modelValue":l[3]||(l[3]=o=>a.value.biography=o),label:"Biography",rows:"2","auto-grow":"",counter:"","persistent-counter":"",density:"compact","data-cy":"biography"},null,8,["modelValue"])]),_:1})]),_:1}),e(r,null,{default:t(()=>[e(u,{cols:"4"},{default:t(()=>[e(n,{modelValue:a.value.email,"onUpdate:modelValue":l[4]||(l[4]=o=>a.value.email=o),label:"Email",density:"compact","data-cy":"email"},null,8,["modelValue"])]),_:1}),e(u,{cols:"4"},{default:t(()=>[e(n,{modelValue:a.value.address,"onUpdate:modelValue":l[5]||(l[5]=o=>a.value.address=o),label:"Address",density:"compact","data-cy":"address"},null,8,["modelValue"])]),_:1}),e(u,{vols:"4"},{default:t(()=>[e(n,{modelValue:a.value.phone,"onUpdate:modelValue":l[6]||(l[6]=o=>a.value.phone=o),label:"Phone Number",density:"compact","data-cy":"phone"},null,8,["modelValue"])]),_:1})]),_:1}),e(r,null,{default:t(()=>[e(u,{cols:"4"},{default:t(()=>[e(n,{modelValue:a.value.wikipedia_page,"onUpdate:modelValue":l[7]||(l[7]=o=>a.value.wikipedia_page=o),label:"Wikipedia Page",density:"compact","data-cy":"wikipedia-page"},null,8,["modelValue"])]),_:1}),e(u,{cols:"4"},{default:t(()=>[e(n,{modelValue:a.value.amazon_author_page,"onUpdate:modelValue":l[8]||(l[8]=o=>a.value.amazon_author_page=o),label:"Amazon Author Page",density:"compact","data-cy":"amazon-author-page"},null,8,["modelValue"])]),_:1}),e(u,{cols:"4"},{default:t(()=>[e(n,{modelValue:a.value.author_website,"onUpdate:modelValue":l[9]||(l[9]=o=>a.value.author_website=o),label:"Author Website",density:"compact","data-cy":"author-website"},null,8,["modelValue"])]),_:1})]),_:1}),e(r,null,{default:t(()=>[e(u,{cols:"4"},{default:t(()=>[e(n,{modelValue:a.value.twitter,"onUpdate:modelValue":l[10]||(l[10]=o=>a.value.twitter=o),label:"X",density:"compact","data-cy":"twitter"},null,8,["modelValue"])]),_:1}),e(u,{cols:"4"},{default:t(()=>[e(n,{modelValue:a.value.instagram,"onUpdate:modelValue":l[11]||(l[11]=o=>a.value.instagram=o),label:"Instagram",density:"compact","data-cy":"instagram"},null,8,["modelValue"])]),_:1}),e(u,{cols:"4"},{default:t(()=>[e(n,{modelValue:a.value.facebook,"onUpdate:modelValue":l[12]||(l[12]=o=>a.value.facebook=o),label:"Facebook",density:"compact","data-cy":"facebook"},null,8,["modelValue"])]),_:1})]),_:1}),e(r,null,{default:t(()=>[e(u,{cols:"4"},{default:t(()=>[e(n,{modelValue:a.value.linkedin,"onUpdate:modelValue":l[13]||(l[13]=o=>a.value.linkedin=o),label:"Linkedin",density:"compact","data-cy":"linkedin"},null,8,["modelValue"])]),_:1}),e(u,{cols:"4"},{default:t(()=>[e(n,{modelValue:a.value.goodreads,"onUpdate:modelValue":l[14]||(l[14]=o=>a.value.goodreads=o),label:"Goodreads",density:"compact","data-cy":"goodreads"},null,8,["modelValue"])]),_:1}),e(u,{cols:"4"},{default:t(()=>[e(n,{modelValue:a.value.tiktok,"onUpdate:modelValue":l[15]||(l[15]=o=>a.value.tiktok=o),label:"TikTok",density:"compact","data-cy":"tiktok"},null,8,["modelValue"])]),_:1})]),_:1}),e(r,null,{default:t(()=>[e(u,{cols:"12"},{default:t(()=>[e(k,{modelValue:a.value.notes,"onUpdate:modelValue":l[16]||(l[16]=o=>a.value.notes=o),label:"Notes",rows:"2","auto-grow":"",counter:"","persistent-counter":"",density:"compact","data-cy":"notes"},null,8,["modelValue"])]),_:1})]),_:1}),e(r,null,{default:t(()=>[e(u,{cols:"12"},{default:t(()=>[e(w,{type:"submit",text:"Save",color:"primary",size:"small","data-cy":"save-contributor"}),e(w,{class:"ml-4",text:"Cancel",size:"small","data-cy":"cancel-contributor",onClick:D})]),_:1})]),_:1})]),_:1},512),e(K,{show:c.value,"item-name":"contributor",onSave:z,onDontSave:S,onCancelled:l[17]||(l[17]=o=>c.value=!1)},null,8,["show"])]),_:1})]),_:1}))}}}),de=Y(Z,[["__scopeId","data-v-a28158f5"]]);export{de as default};
